<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="csrf-token" content={get_csrf_token()} />
    <.live_title default="ClawdEx">
      {assigns[:page_title]}
    </.live_title>
    <link phx-track-static rel="stylesheet" href={~p"/assets/css/app.css"} />
    <script defer phx-track-static type="text/javascript" src={~p"/assets/js/app.js"}>
    </script>
    <style>
      /* Custom scrollbar */
      .scrollbar-thin::-webkit-scrollbar { width: 6px; }
      .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
      .scrollbar-thin::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 3px; }
    </style>
  </head>
  <body class="h-full bg-gray-900 text-gray-100">
    <div class="flex h-full">
      <!-- Sidebar -->
      <aside class="w-64 bg-gray-950 border-r border-gray-800 flex flex-col flex-shrink-0">
        <!-- Logo -->
        <div class="p-4 border-b border-gray-800">
          <a href="/" class="flex items-center gap-3">
            <span class="text-2xl">ğŸ¤–</span>
            <span class="text-xl font-bold text-white">ClawdEx</span>
          </a>
        </div>
        
<!-- Navigation -->
        <nav class="flex-1 p-4 flex flex-col gap-1" id="sidebar-nav">
          <a
            href="/"
            data-path="/"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">ğŸ“Š</span>
            <span>Dashboard</span>
          </a>
          <a
            href="/chat"
            data-path="/chat"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">ğŸ’¬</span>
            <span>Chat</span>
          </a>
          <a
            href="/sessions"
            data-path="/sessions"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">ğŸ“‹</span>
            <span>Sessions</span>
          </a>
          <a
            href="/agents"
            data-path="/agents"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">ğŸ¤–</span>
            <span>Agents</span>
          </a>
          <a
            href="/cron"
            data-path="/cron"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">â°</span>
            <span>Cron Jobs</span>
          </a>
          
          <div class="my-2 border-t border-gray-800"></div>
          
          <a
            href="/logs"
            data-path="/logs"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">ğŸ“œ</span>
            <span>Logs</span>
          </a>
          <a
            href="/settings"
            data-path="/settings"
            class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white transition-colors"
          >
            <span class="text-xl">âš™ï¸</span>
            <span>Settings</span>
          </a>
        </nav>
        <script>
          (function() {
            const path = window.location.pathname;
            document.querySelectorAll('#sidebar-nav a').forEach(link => {
              const linkPath = link.dataset.path;
              if (linkPath === '/' ? path === '/' : path.startsWith(linkPath)) {
                link.classList.add('bg-gray-800', 'text-white');
              }
            });
          })();
        </script>
        
<!-- Footer -->
        <div class="p-4 border-t border-gray-800">
          <div class="text-xs text-gray-500">ClawdEx v0.1.0</div>
        </div>
      </aside>
      
<!-- Main Content -->
      <main class="flex-1 overflow-auto scrollbar-thin">
        <!-- Flash Messages -->
        <div class="fixed top-4 right-4 z-50 flex flex-col gap-2" id="flash-container">
          <%= if Phoenix.Flash.get(@flash, :info) do %>
            <div
              class="bg-blue-600 text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2"
              role="alert"
              phx-click={JS.push("lv:clear-flash", value: %{key: "info"}) |> JS.hide()}
            >
              <span>â„¹ï¸</span>
              <span>{Phoenix.Flash.get(@flash, :info)}</span>
              <button class="ml-auto">âœ•</button>
            </div>
          <% end %>
          <%= if Phoenix.Flash.get(@flash, :error) do %>
            <div
              class="bg-red-600 text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2"
              role="alert"
              phx-click={JS.push("lv:clear-flash", value: %{key: "error"}) |> JS.hide()}
            >
              <span>âš ï¸</span>
              <span>{Phoenix.Flash.get(@flash, :error)}</span>
              <button class="ml-auto">âœ•</button>
            </div>
          <% end %>
        </div>

        {@inner_content}
      </main>
    </div>
  </body>
</html>
